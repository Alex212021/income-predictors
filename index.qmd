---
title: "Determinants of Income"
execute: 
  echo: false
  warning: false
---

**A person's income is determined by many factors, but which are the best predictors?**

To answer our question, we used the data from the General Social Survey from 2022, and the gssr package to analyze the data. We modeled income as a linear function of intelligence, race, education, political views, age, and gender. Individuals with higher levels of education and wordsum scores, and those identifying as White, were more likely to have higher incomes.

```{r}
#| label: setup
#| message: FALSE
library(gssr)
library(brms)
library(tidybayes)
library(gtsummary)
library(tidyverse)
library(haven)
```

```{r}
#| label: cleaning
#| message: FALSE 

data(gss_all)

data_gss <- gss_all |>
  filter(year == 2022) |>
  select(conrinc, wordsum, race, educ, polviews, age, sex) |> 
  mutate(
    conrinc = as.numeric(conrinc),
    wordsum = as.numeric(wordsum),
    race = as_factor(race),
    educ = as.numeric(educ),
    polviews = as_factor(polviews),
    age = as.numeric(age),
    sex = as_factor(sex)) |>
  drop_na()
```

```{r}
#| label: model
#| cache: true

model <- brm(conrinc ~ wordsum + race + educ + polviews + age + sex, 
             data = data_gss, 
             family = gaussian(),
             silent = 2,
             refresh = 0,
             seed = 123)

```

```{r}
#| label: table

model |> 
  tbl_regression()


```
