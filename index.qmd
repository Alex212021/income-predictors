---
title: "Predicting Income"
execute: 
  echo: false
  warning: false
---

**A person's income is determined by many factors, but which are the best predictors?**

To answer our question, we used the data from the General Social Survey from 2022, and the gssr package to analyze the data. We modeled income as a linear function of intelligence, race, education and gender. 

```{r}
#| label: setup
#| message: FALSE
library(gssr)
library(brms)
library(tidybayes)
library(gtsummary)
library(tidyverse)
library(haven)
```

```{r}
#| label: cleaning
#| message: FALSE 

data(gss_all)

data_gss <- gss_all |>
  filter(year == 2022) |>
  select(conrinc, wordsum, race, educ, sex) |> 
  mutate(
    conrinc = as.numeric(conrinc),
    wordsum = as.numeric(wordsum),
    race = as_factor(race),
    educ = as.numeric(educ),
    sex = as_factor(sex)) |>
  drop_na()
```

```{r}
data_gss |> ggplot(aes(x = educ, y = conrinc))+
  geom_jitter(alpha = 0.1, color = "blue") +
  geom_smooth(method = "lm", se = FALSE, color = "red", size = 1.5)+
  labs(x = "Education (years completed)",
       y = "Personal income (inflation-adjusted)",
       title = "More Educated Tend To Have Higher Incomes")+
  theme_classic()
```


```{r}
#| label: model
#| cache: true

model <- brm(conrinc ~ wordsum + race + educ + sex, 
             data = data_gss, 
             family = gaussian(),
             silent = 2,
             refresh = 0,
             seed = 123)

```

```{r}
#| label: table

model |> 
  tbl_regression()


```

As the table of regression coefficients shows, individuals with higher income tend to be White, male, more educated and with higher "wordsum" scores (interpreted as "with higher IQ scores").